Commit 643 on 2024-05-29 23:02:53: Refactored loop for better performance