Commit 997 on 2024-06-08 23:04:19: Refactored code for better readability